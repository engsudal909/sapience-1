---
title: "Deploy a Market Making Agent"
description: "Fork and run the minimal market making starter to provide auction liquidity on Sapience."
---

import BuilderGuideAlert from '../../../components/BuilderGuideAlert'

<BuilderGuideAlert />

# Deploy a Market Making Agent

Use our minimal starter to listen for auction requests and submit signed bids as a liquidity provider.

<div style={{ display: 'flex', gap: '8px', alignItems: 'center', flexWrap: 'wrap' }}>
  <a href="https://github.com/sapiencexyz/sapience/tree/main/starters/market-maker">
    <img alt="Open starter on GitHub" src="https://img.shields.io/badge/Open%20starter%20on%20GitHub-sapiencexyz%2Fsapience-181717?logo=github" />
  </a>
  <a href="https://github.com/sapiencexyz/sapience/fork">
    <img alt="Fork this repo" src="https://img.shields.io/badge/Fork%20this%20repo-181717?logo=github" />
  </a>
  <a href="https://www.npmjs.com/package/@sapience/sdk">
    <img alt="SDK on npm" src="https://img.shields.io/npm/v/%40sapience%2Fsdk" />
  </a>
  <a href="/builder-guide/api/auction-relayer">
    <img alt="Auction Relayer API" src="https://img.shields.io/badge/API-Auction%20Relayer-blue" />
  </a>
  <a href="/builder-guide/api/graphql">
    <img alt="GraphQL API" src="https://img.shields.io/badge/API-GraphQL-blue" />
  </a>
  <a href="/builder-guide/reference/contracts-and-addresses">
    <img alt="Contracts & Addresses" src="https://img.shields.io/badge/Reference-Contracts%20%26%20Addresses-6f42c1" />
  </a>
  
</div>

## What you’ll build

- Connects to the Auction Relayer WebSocket
- Performs a one‑time MAX ERC‑20 approval for the `PredictionMarket` contract
- Filters auctions by taker wager and sends a fixed‑amount maker bid
- Signs maker bids with EIP‑712 using your private key

## Quickstart

Prereqs: Node 18+, pnpm

```bash
git clone https://github.com/sapiencexyz/sapience
cd sapience/starters/market-maker
pnpm install

# Copy and add your private key
cp env.example .env

# Run with local SDK linked from monorepo
pnpm dev

# Or, run against the published SDK
pnpm dev:published
```

## How it works

1. Connect to the relayer WebSocket
2. Listen for `auction.started { auctionId, taker, wager, predictions[], chainId, marketContract }`
3. Filter out small auctions via `MIN_TAKER_WAGER`
4. Ensure ERC‑20 approval (one‑time MAX) for the `PredictionMarket` contract
5. Build EIP‑712 typed data (maker bid) and sign with `PRIVATE_KEY`
6. Send `bid.submit { auctionId, maker, makerWager, makerDeadline, makerSignature, makerNonce }`
7. Handle `bid.ack { error? }` and optionally observe `auction.bids`
8. Auto‑reconnect on close/error

## Code walkthrough (starter highlights)

- Configuration & defaults: resolves `RELAYER_WS_URL`, `RPC_URL`, and contract addresses from the SDK
- One‑time approval: checks allowance and sends `approve(MAX)` if needed
- WebSocket handlers: reacts to `auction.started`, `bid.ack`, and `auction.bids`
- Market metadata: decodes `auction.predictions[0].predictedOutcomes` and fetches condition titles via GraphQL for readable logs
- Signing: uses helpers to build and sign the EIP‑712 maker bid payload with domain `{ chainId: auction.chainId, verifyingContract: uniqueVerifierFromPredictions }` and inner hash `{ predictionsHash, makerWager, makerDeadline }`
- Strategy knobs: `BID_AMOUNT`, `MIN_TAKER_WAGER`, `DEADLINE_SECONDS`

Minimal bid submission (excerpt):

```ts
const { domain, types, primaryType, message } = buildMakerBidTypedData({
  auction: {
    taker: auction.taker,
    predictions: auction.predictions,
    wager: auction.wager,
    chainId: auction.chainId,
    marketContract: auction.marketContract,
  },
  makerWager,
  makerDeadline,
  maker: MAKER,
});

const makerSignature = await signMakerBid({ privateKey: PRIVATE_KEY_HEX, domain, types, primaryType, message });

ws.send(JSON.stringify({
  type: 'bid.submit',
  payload: { auctionId, maker: MAKER, makerWager: String(makerWager), makerDeadline, makerSignature, makerNonce },
}));
```

## Customize your strategy

- Adjust `MIN_TAKER_WAGER` to target larger auctions only
- Change `BID_AMOUNT` sizing or derive it from `auction.wager`
- Filter by topic or condition group by inspecting decoded `predictedOutcomes`
- Add risk checks: time windows, max exposure, per‑maker rate limits

## Safety and risks

::::warning
- Use a dedicated wallet and start with small amounts
- Approvals are MAX by default; revoke if needed after testing
- Keep your `PRIVATE_KEY` secure and never commit it to source control
::::

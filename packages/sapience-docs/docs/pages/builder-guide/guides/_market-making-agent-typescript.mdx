## TypeScript Market Maker Starter

<div style={{ display: 'flex', gap: '8px', alignItems: 'center', flexWrap: 'wrap', marginBottom: '1rem' }}>
  <a href="https://github.com/sapiencexyz/sapience/tree/main/starters/market-maker">
    <img alt="Market Maker Starter on GitHub" src="https://img.shields.io/badge/Market%20Maker%20Starter-sapiencexyz%2Fsapience-181717?logo=github" />
  </a>
  <a href="https://www.npmjs.com/package/@sapience/sdk">
    <img alt="SDK on npm" src="https://img.shields.io/npm/v/%40sapience%2Fsdk" />
  </a>
</div>

The [market-maker starter](https://github.com/sapiencexyz/sapience/tree/main/starters/market-maker) is a ready-to-run TypeScript bot that provides liquidity by bidding on auction requests.

### What It Does

- Connects to the Auction Relayer WebSocket
- Listens for `auction.started` events from traders
- Filters auctions by minimum wager size
- Signs bids with EIP-712 and submits them
- Handles one-time MAX token approval for USDe
- Auto-reconnects on connection errors

### Quickstart

```bash
git clone https://github.com/sapiencexyz/sapience
cd sapience/starters/market-maker
pnpm install

# Configure your private key
cp env.example .env
# Edit .env and set PRIVATE_KEY

# Run the bot
pnpm dev
```

### Configuration

Edit `.env` to customize the bot behavior:

```bash
# Required
PRIVATE_KEY=your_private_key_here

# Strategy parameters
BID_AMOUNT=0.01           # Amount to bid in USDe (human readable)
MIN_MAKER_WAGER=10        # Minimum auction size to bid on
DEADLINE_SECONDS=60       # How long your bid is valid

# Optional overrides
RELAYER_WS_URL=wss://api.sapience.xyz/auction
CHAIN_ID=42161            # Arbitrum One
RPC_URL=                  # Uses public RPC if not set
```

### How It Works

The bot follows this flow:

1. **Connect** to the auction relayer WebSocket
2. **Listen** for `auction.started` messages
3. **Filter** auctions below `MIN_MAKER_WAGER`
4. **Approve** USDe token (one-time MAX approval)
5. **Sign** the bid using EIP-712 typed data via SDK helpers
6. **Submit** the bid with `bid.submit` message
7. **Handle** `bid.ack` confirmation or error

### Core Bid Submission Code

The starter uses the SDK's signing helpers:

```typescript
import { buildMakerBidTypedData, signMakerBid } from '@sapience/sdk/auction';

// Build EIP-712 typed data for the bid
const { domain, types, primaryType, message } = buildMakerBidTypedData({
  auction: {
    taker: auction.taker,
    resolver: auction.resolver,
    predictedOutcomes: auction.predictedOutcomes,
    wager: auction.wager,
  },
  makerWager: parseEther(BID_AMOUNT),
  makerDeadline: Math.floor(Date.now() / 1000) + DEADLINE_SECONDS,
  chainId: CHAIN_ID,
  verifyingContract: PREDICTION_MARKET_ADDRESS,
  maker: YOUR_ADDRESS,
});

// Sign the bid
const signature = await signMakerBid({ 
  privateKey, domain, types, primaryType, message 
});

// Submit to relayer
ws.send(JSON.stringify({
  type: 'bid.submit',
  payload: { auctionId, maker, makerWager, makerDeadline, makerSignature, makerNonce },
}));
```

### Customize Your Strategy

The starter is intentionally simple. Extend it by:

- **Sizing bids dynamically** based on `auction.wager` or market conditions
- **Filtering by market** using decoded `predictedOutcomes` to target specific topics
- **Adding risk limits** like max total exposure or per-taker rate limits
- **Integrating forecasts** to price bids based on your probability estimates

### Safety Notes

:::warning
- Use a dedicated wallet with limited funds
- Start with small `BID_AMOUNT` values while testing
- Token approvals are set to MAX by default
- Never commit your `PRIVATE_KEY` to source control
:::

### Resources

- [Market Maker Starter Repository](https://github.com/sapiencexyz/sapience/tree/main/starters/market-maker)
- [Auction Relayer API](/builder-guide/api/auction-relayer) - Full WebSocket protocol
- [`@sapience/sdk` on npm](https://www.npmjs.com/package/@sapience/sdk) - SDK documentation

